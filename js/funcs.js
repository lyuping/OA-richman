!function(){function t(){var t=null,i=null,n=null,e=function(t){return"M 0 0 m -"+t+", 0 a "+t+","+t+" 0 1,0 "+2*t+",0 a "+t+","+t+" 0 1,0 -"+2*t+",0"},o=function(){return"m-16,0 a16,5 0 1 0 32,0 l-11,-24 a12.5,12.5 0 1 0 -6,0 l-14,25"},s=function(t,i){var n=t.lat()-i.lat(),e=t.lng()-i.lng(),o=(Math.abs(n)+Math.abs(e))/2,s=10>o?1>o?.1>o?.01>o?.001>o?1e-4>o?3:6:9:12:15:24:21,r=n/s,a=e/s;return Math.abs(r)>0||Math.abs(a)>0?{unit:s,lat:r,lng:a}:null},r=function(i,n,e,o){o>e&&(t.setCenter(new google.maps.LatLng(t.getCenter().lat()+i,t.getCenter().lng()+n)),setTimeout(function(){r(i,n,e+1,o)},50))},a=function(i){var n=t.getCenter(),e=s(i,n);return e?(r(e.lat,e.lng,0,e.unit),void 0):!1};this.initMap=function(i,n){return n=$.extend({zoom:16,scaleControl:!0,navigationControl:!1,mapTypeControl:!1,zoomControl:!1,scrollwheel:!1,streetViewControl:!1,center:new google.maps.LatLng(23.568038757736595,120.30465692281723)},n),t=new google.maps.Map(i.get(0),n),this},this.initMarkerInfos=function(n){return i=n.map(function(i){return i.userCount=0,i.getPosition=function(){return this.position},i.setPosition=function(t){return this.marker&&this.marker.setPosition(t),this},i.marker=new google.maps.Marker({map:t,draggable:!1,position:i.position,icon:{path:e(20),strokeColor:"rgba(50, 60, 140, 1)",strokeWeight:1,fillColor:"rgba(68, 77, 145, .85)",fillOpacity:.5}}),i}),this},this.initPolyline=function(){return n=new google.maps.Polyline({map:t,path:i.map(function(t){return t.marker.getPosition()}),strokeColor:"rgba(102, 217, 239, .5)",strokeWeight:10}),this},this.init=function(e,o){try{return this.initMap(e).initMarkerInfos(o).initPolyline(),t&&i&&n?!0:!1}catch(s){return!1}},this.setUserPosition=function(t){if(t)return this.marker.setPosition(t),this;if(!i[this.index])return!1;switch(i[this.index].userCount){case 0:t=new google.maps.LatLng(i[this.index].getPosition().lat(),i[this.index].getPosition().lng());break;case 1:t=new google.maps.LatLng(i[this.index].getPosition().lat(),i[this.index].getPosition().lng()+5e-4);break;case 2:t=new google.maps.LatLng(i[this.index].getPosition().lat(),i[this.index].getPosition().lng()-5e-4);break;case 3:t=new google.maps.LatLng(i[this.index].getPosition().lat()+5e-4,i[this.index].getPosition().lng());break;case 4:t=new google.maps.LatLng(i[this.index].getPosition().lat()-5e-4,i[this.index].getPosition().lng())}return t?(this.marker.setPosition(t),i[this.index].userCount+=1,this):!1},this.userMove=function(t,n,e,o,s){return o>=s?(this.index=(this.index+1)%i.length,t>1?this.goStep(t-1):(this.setPosition(),a(this.getPosition()),!0)):(this.setPosition(new google.maps.LatLng(this.getPosition().lat()+n,this.getPosition().lng()+e)),setTimeout(function(){this.move(t,n,e,o+1,s)}.bind(this),50),void 0)},this.userGoStep=function(t){if(1>t)return!1;var n=this.getPosition(),e=i[(this.index+1)%i.length].getPosition(),o=s(e,n);return o?(i[this.index].userCount-=1,this.move(t,o.lat,o.lng,0,o.unit),void 0):!1},this.createUser=function(){return{index:0,move:this.userMove,goStep:this.userGoStep,setPosition:this.setUserPosition,getPosition:function(){return this.marker?this.marker.getPosition():null},marker:new google.maps.Marker({map:t,draggable:!1,icon:{path:o(),strokeColor:"rgba(200, 0, 0, .9)",strokeWeight:1,fillColor:"rgba(200, 0, 0, .9)",fillOpacity:.5}})}}}window.funcs=t}();